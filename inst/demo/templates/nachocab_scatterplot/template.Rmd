```{r engine="coffee", results="asis", echo=FALSE }
    # data should have x, y and name
    dec_format = d3.format(".2f")

    d3.json("{{opts$relative_data_path}}", (data) ->

        plot = append_plot(
            width: {{opts$template_config$width}}
            height: {{opts$template_config$height}}
        )

        plot.scales.x.domain([d3.min(data, (d) -> d.x), d3.max(data, (d) -> d.x)])
        plot.scales.x = add_padding(plot.scales.x)

        plot.scales.y.domain([d3.min(data, (d) -> d.y), d3.max(data, (d) -> d.y)])
        plot.scales.y = add_padding(plot.scales.y)

        plot = draw_axes(plot)

        radius = 5

        svg = plot.append("svg:g")
            .call(d3.behavior.zoom().x(plot.scales.x).y(plot.scales.y).scaleExtent([1, Infinity]).on("zoom", ()-> semantic_zoom() ))

        # we need this to allow zooming anywhere on the svg, not only on top of a circle
        svg.append("rect")
            .attr("class", "overlay")
            .attr("width",  plot.width)
            .attr("height", plot.height)
            .attr("fill", "none")
            .attr("pointer-events","all")
            .style("cursor","move")

        transform = (d) ->
          "translate(#{plot.scales.x(d.x)},#{plot.scales.y(d.y)})"

        circles = svg.selectAll("circle")
            .data(data)
          .enter().append("svg:circle")
            .attr("r", radius)
            .attr("title",(d) -> "<strong>#{d.name}</strong><br>x: #{dec_format(d.x)}<br>y: #{dec_format(d.y)}")
            .attr("class", "circle_tooltip")
            .attr("transform", transform)

        names = svg.selectAll("text")
              .data(data, (d) -> d.name)
            .enter().append("text")
              .attr("dy",".32em")
              .attr("dx","8") #
              .attr("text-anchor","left")
              .text((d) -> d.name)
              .attr("transform", transform)
              .attr("display","none")

        semantic_zoom = () ->
            # d3.event.stopPropagation()
            circles.attr("transform", transform)
            names.attr("transform", transform)


        $(".circle_tooltip").tooltip
            html: true
            container: "body"
            placement: "top"


        show_names_button = plot.append("g")
            .attr("transform","translate(#{plot.width},#{0})")
            .style("cursor", "pointer")
            .style("font-size","15px")
            .on("click", () -> change() )

        d3.select(window).on("keydown", () ->
            # switch (d3.event.keyCode) {
              # case : year = Math.max(year0, year - 10); break;
              # case 39: year = Math.min(year1, year + 10); break;
            # }
            # console.log(d3.event.keyCode)
            if (d3.event.keyCode in [78, 32]) # 'n' or 'space bar'
                change()
        )

        show_names_button.append("circle")
            .attr("r", 7)
            .attr("stroke","black")
            .attr("stroke-width",2)

        show_names_button.append("text")
            .attr('text-anchor', 'start')
            .attr('dy', '.32em')
            .attr('dx', '12')


        change = ()->
            if show_names_button.classed("show_names")
                show_names_button.attr("class","")
                update()
            else
                show_names_button.attr("class","show_names")
                update()

        update = ()->
            if show_names_button.classed("show_names")
                names.attr("display", "inline")
                show_names_button.select("circle").attr("fill","black")
                # show_names_button.select("text").text(" Hide names")
            else
                names.attr("display", "none")
                show_names_button.select("circle").attr("fill","white")
                show_names_button.select("text").text("Show names")

        update()
    )

```